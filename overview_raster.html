<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>ISCE: Raster Data Model in ISCE</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ISCE
   &#160;<span id="projectnumber">3.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="sphinx/html/index.html"><span>Python&#160;classes</span></a></li>
      <li><a href="https://github-fn.jpl.nasa.gov/ericmg/isce/issues/"><span>Issue&#160;Tracker</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Raster Data Model in ISCE </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#gdal">Raster Data Model</a><ul><li class="level2"><a href="#rastercreate">Raster creation</a></li>
<li class="level2"><a href="#rasterread">Reading Rasters</a></li>
<li class="level2"><a href="#drivers">Special drivers</a><ul><li class="level3"><a href="#rastervrt">Virtual Raster Table (VRT) driver</a></li>
<li class="level3"><a href="#rasterhdf5">HDF5 driver</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#areapoint">Pixel is Area</a><ul><li class="level2"><a href="#GeoTransform"></a></li>
<li class="level2"><a href="#pixelexample">Example: SRTM vs NED</a></li>
</ul>
</li>
<li class="level1"><a href="#rasterproj">Projections</a><ul><li class="level2"><a href="#rastervert">Vertical Datum</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="gdal"></a>
Raster Data Model</h1>
<p>ISCE delegates raster data handling to the Geospatial Data Abstraction Library (<a href="https://www.gdal.org">GDAL</a>). Hence, it uses all the conventions defined by the <a href="http://www.gdal.org/gdal_datamodel.html">GDAL data model</a> to simplify the interface. You will find detailed documentation of all the methods available here: <a class="el" href="classisce_1_1io_1_1Raster.html" title="Data structure meant to handle Raster I/O operations. ">isce::io::Raster</a>.</p>
<h2><a class="anchor" id="rastercreate"></a>
Raster creation</h2>
<p>ISCE exposes access to GDAL's raster generation capabilities via it's most general constructor interface</p>
<p><a class="el" href="classisce_1_1io_1_1Raster.html" title="Data structure meant to handle Raster I/O operations. ">isce::io::Raster(const std::string&amp; fname, size_t width, size_t length, size_t numBands, GDALDataType dtype, const std::string&amp; driverName)</a></p>
<p>This method provides direct access to GDALGetDriverManager()-&gt;GetDriverByName()-&gt;Create() methods in C++. This provides users with the capability to generate raster imagery in any format with write-support in GDAL. See this <a href="https://www.gdal.org/formats_list.html">table</a> for list of formats supported by GDAL.</p>
<h2><a class="anchor" id="rasterread"></a>
Reading Rasters</h2>
<p>Since, ISCE delegates Raster data access to GDAL, (in theory) users should be able to read in any raster format that GDAL supports. A Raster can be easily opened for ReadOnly Access by just passing the filename to the constructor</p>
<p><a class="el" href="classisce_1_1io_1_1Raster.html" title="Data structure meant to handle Raster I/O operations. ">isce::io::Raster(std::string&amp; fname)</a></p>
<p>The same applies to <a href="https://www.gdal.org/gdal_virtual_file_systems.html">virtual file systems</a> supported by GDAL as well.</p>
<h2><a class="anchor" id="drivers"></a>
Special drivers</h2>
<h3><a class="anchor" id="rastervrt"></a>
Virtual Raster Table (VRT) driver</h3>
<p>The <a href="https://www.gdal.org/gdal_vrttut.html">VRT</a> driver is considered a special driver by ISCE and is handled differently during Raster creation. When a user asks a Raster to be created with the VRT driver, it is assumed that the user is requesting a raw binary file on disk with the metadata captured in a VRT file with VRTRawRasterBands.</p>
<p>This behavior is meant to replicate the imagery file with an auxilary metadata file model used by ROI_PAC (.rsc) and ISCE v2 (.xml). VRT format allows for other metadata to be stored under custom metadata domains and includes support for special handling of xml strings.</p>
<p>Note that VRT format files are only handled differently during creation. VRTs created by other workflows behave like other normal GDAL datasets for reading / updating.</p>
<h3><a class="anchor" id="rasterhdf5"></a>
HDF5 driver</h3>
<p>The HDF5 driver is considered a special driver by ISCE and is handle differently during Raster creation and reading. GDAL's HDF5 driver does not provide write or update capability, and ISCE relies on its own custom implmentation to support working with NISAR products that are in HDF5 format. More details to follow soon.</p>
<h1><a class="anchor" id="areapoint"></a>
Pixel is Area</h1>
<p>ISCE uses the same convention as GDAL, i.e coordinates of a raster image are interpreted using the "PixelIsArea" convention.</p>
<div class="image">
<img src="Raster_layout.png" alt="Raster_layout.png"/>
</div>
<p>The key features of "PixelIsArea" convention are </p>
<ol>
<li>
(0,0) represents the Top-Left corner of the first pixel in the first line of the raster </li>
<li>
(nPixels, 0) represents the Top-Right corner of the the last pixel in the first line of the raster  </li>
<li>
(0, nLines) represents the Bottom-Left corner of the first pixel in the last line of the raster  </li>
<li>
(nPixels, nLines) represents the Bottom-Right corner of the last pixel in the last line of the raster  </li>
<li>
A pixel in the raster is indexed using its Top-Left corner position. </li>
</ol>
<p>For more details on the "PixelIsArea" and "PixelIsPoint" conventions - see the <a href="http://geotiff.maptools.org/spec/geotiff2.5.html">Geotiff</a> spec.</p>
<h2><a class="anchor" id="GeoTransform"></a>
GeoTransform</h2>
<p>ISCE delegates the association of map coordinates (East, North) to image coordinates (Column, Row) to GDAL and uses the <a href="https://www.gdal.org/gdal_datamodel.html">Affine GeoTransform </a> mechanism to represent this mapping. GeoTransform of a raster image refers to collection of six double precisiion numbers such that</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left[ \begin{array}{c} X_{left} \\ Y_{top} \end{array} \right] = \left[ \begin{array}{c} G_0 \\ G_3 \end{array}\right] + \left[ \begin{array}{cc} G_1 &amp; G_2 \\ G_4 &amp; G_5 \end{array} \right] \cdot \left[ \begin{array}{c} P \\ L \end{array} \right] \]" src="form_90.png"/>
</p>
<p>where P and L refer to integer pixel (column) and line (row) indices of pixel of interest, and <img class="formulaInl" alt="$X_{left}$" src="form_91.png"/> and <img class="formulaInl" alt="$Y_{top}$" src="form_92.png"/> corresponds to the geographical coordinates of the Top-Left corner.</p>
<h2><a class="anchor" id="pixelexample"></a>
Example: SRTM vs NED</h2>
<p>SRTM uses "pixelIsPoint" convention whereas NED uses "pixelIsArea" convention. See <a href="https://topochange.cr.usgs.gov/vertical.php">this link</a> for detailed explanation.</p>
<p>Consequently, map coordinates of SRTM data has to be labelled correctly for use with ISCE. This example is to emphasize that when users bring in their own datasets to work with ISCE - they should be annotated correctly with "pixelIsArea" Affine Geotransform information.</p>
<p>Fortunately, GDAL takes care of this adjustment already for SRTM format datasets. You can verify this by running "gdalinfo" on an SRTM tile. Note that the geographic coordinates corresponding to the Top-Left corner has been adjusted by half a pixel to conform to the "pixelIsArea" convention.</p>
<pre class="fragment">&gt; gdalinfo N34W120.hgt
Driver: SRTMHGT/SRTMHGT File Format
Files: N34W120.hgt
Size is 1201, 1201
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","4326"]]
Origin = (-120.000416666666666,35.000416666666666)
Pixel Size = (0.000833333333333,-0.000833333333333)
Metadata:
  AREA_OR_POINT=Point
Corner Coordinates:
Upper Left  (-120.0004167,  35.0004167) (120d 0' 1.50"W, 35d 0' 1.50"N)
Lower Left  (-120.0004167,  33.9995833) (120d 0' 1.50"W, 33d59'58.50"N)
Upper Right (-118.9995833,  35.0004167) (118d59'58.50"W, 35d 0' 1.50"N)
Lower Right (-118.9995833,  33.9995833) (118d59'58.50"W, 33d59'58.50"N)
Center      (-119.5000000,  34.5000000) (119d30' 0.00"W, 34d30' 0.00"N)
Band 1 Block=1201x1 Type=Int16, ColorInterp=Undefined
  NoData Value=-32768
  Unit Type: m</pre><h1><a class="anchor" id="rasterproj"></a>
Projections</h1>
<p>While GDAL is used to handle rasters within ISCE, ISCE only handles a small subset of projection systems that are supported by GDAL. ISCE exclusively uses <a href="http://www.epsg.org/">EPSG</a> codes for coordinate projection. A CUDA implementation of projection transformations has also been implemented for GPU-based processing. Note that all ISCE supported projections are defined on a WGS84 ellipsoid.</p>
<table class="doxtable">
<caption id="projections" align="bottom">Table of supported projections in ISCE</caption>
<tr>
<th>EPSG code</th><th>PROJ.4 string</th><th>Common name </th></tr>
<tr>
<td><a href="https://epsg.io/4326">4326</a></td><td>+proj=longlat +datum=WGS84 +no_defs</td><td>WGS84 Lon/Lat </td></tr>
<tr>
<td><a href="https://epsg.io/3031">3031</a></td><td>+proj=stere +lat_0=-90 +lat_ts=-71 +lon_0=0 +k=1</td><td>Antarctic Polar Stereographic </td></tr>
<tr>
<td><a href="https://epsg.io/3413">3413</a></td><td>+proj=stere +lat_0=90 +lat_ts=70 +lon_0=-45 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs</td><td>NSIDC Polar Stereographic North </td></tr>
<tr>
<td><a href="https://epsg.io/32600">32600+X</a></td><td>+proj=utm +zone=X +datum=WGS84 +units=m +no_defs</td><td>Standard UTM zone North </td></tr>
<tr>
<td><a href="https://epsg.io/32700">32700+X</a></td><td>+proj=utm +zone=X +south +datum=WGS84 +units=m +no_defs</td><td>Standard UTM zone South </td></tr>
<tr>
<td><a href="https://epsg.io/6933">6933</a></td><td>+proj=cea +lon_0=0 +lat_ts=30 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs</td><td>EASE 2.0 global grid </td></tr>
</table>
<h2><a class="anchor" id="rastervert"></a>
Vertical Datum</h2>
<p>Internally, ISCE needs all DEM heights to be referenced w.r.t WGS84 ellipsoid. However, it can delegate vertical datum transformation for a small subset of geoids to GDAL (gdalwarp with vertical datum). The set of supported geoids are</p>
<table class="doxtable">
<caption id="geoids" align="bottom">Table of supported geoids in ISCE</caption>
<tr>
<th>EPSG code</th><th>Name of Geoid</th><th>URL </th></tr>
<tr>
<td>5773</td><td>EGM 96</td><td><a href="https://en.wikipedia.org/wiki/EGM96">https://en.wikipedia.org/wiki/EGM96</a> </td></tr>
<tr>
<td>3885</td><td>EGM 08</td><td><a href="http://earth-info.nga.mil/GandG/wgs84/gravitymod/egm2008/egm08_wgs84.html">http://earth-info.nga.mil/GandG/wgs84/gravitymod/egm2008/egm08_wgs84.html</a> </td></tr>
</table>
</div></div><!-- contents -->
<hr>
Generated for ISCE3.0 by
<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.8.5.
</body>
</html>
